$(function(){function t(t){u.empty();var n=t||parseInt(d.val()),a=n-4;o=a,i.text(n);for(var r=a;r<n+1;r++)$("<li>"+r+"</li>").appendTo(u);e()}function e(){for(var t=$(".year-item li"),e=0;e<t.length;e++)!function(e){$(t[e]).click(function(t){r=$(t.target).text(),d.val(r),y.addClass("none")})}(e)}function n(t){var e="year="+(t||(new Date).getFullYear());$.ajax({type:"POST",url:common_url+"/watersys/getMeterInstallInfo.do",dataType:"json",context:document.body,data:e,timeout:5e3,success:function(t){0===t.msg?(console.log(t),a(t,t.dataList)):(alert("您所查询的年份没有数据！"),console.log("未返回任何数据！"))},error:function(){console.log("ajax error")}})}function a(t,e){p.empty(),s.css("display","none");for(var n=0;n<e.length;n++)!function(t){var a=$("<tr><td>"+e[n].installTime+"</td><td>"+e[n].meterCodeNum+"</td>");p.append(a)}();p.append($("<tr><td>总计</td><td>"+t.totalNum+"</td></tr>"))}var o,r,l=$(".pre-year"),c=$(".next-year"),i=$(".year-title span"),s=($(".line-no-data"),$(".table-no-data")),d=($("#select-year"),$(".year-input")),u=$(".year-item"),f=($(".year-item li"),$(".confirm-btn")),y=$(".select-year-wrapper"),m=$(".search-btn"),p=$(".month-tbody");d.val((new Date).getFullYear()),d.click(function(){y.removeClass("none"),t()}),$(document).click(function(t){var e=t.target,n=$.inArray(y[0],$(e).parents());e!==y[0]&&e!==d[0]&&n<0&&y.addClass("none")}),l.click(function(){t(o-1)}),c.click(function(){t(o+9)}),t(),f.click(function(t){r=(new Date).getFullYear(),d.val(r),y.addClass("none")}),m.click(function(){n(d.val())})});